<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>神社検定クイズ - 出題</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body id="page-questions">
  <div class="container">
    <div id="progress-bar-container"><div id="progress-bar"></div></div>
    <div id="question-box">
      <div id="question-number"></div>
      <div id="common-text" class="common-text" style="display:none;"></div>
      <div id="question-text"></div>
      <div id="options" class="options-grid"></div>
      <div class="feedback-container"><span id="feedback-message"></span></div>
    </div>
  </div>
  <script src="main.js" defer></script>
</body>
</html>
        const response = await fetch(`main_questions_${examRound}.json`);
        if (!response.ok) throw new Error(`ファイルが見つからないか、読み込めませんでした`);
        const allQuestions = await response.json();

        if (!Array.isArray(allQuestions)) throw new Error("読み込んだデータが配列ではありません");

        const selectedQuestions = allQuestions.slice(0, questionCount);

        for (let i = 0; i < selectedQuestions.length; i++) {
          const q = selectedQuestions[i];
          if (!q.question || !Array.isArray(q.choices) || typeof q.answer !== 'number') {
            throw new Error(`問題データが不正です（${i + 1}問目）`);
          }
        }

        questions = selectedQuestions;
        showQuestion();
      } catch (error) {
        container.innerHTML = `<p>問題データの読み込みに失敗しました。</p>`;
        console.error(error);
      }
    }

    function showQuestion() {
      if (currentIndex >= questions.length) {
        container.innerHTML = `<p>テスト終了！正解数: ${score} / ${questions.length}</p>`;
        return;
      }

      const q = questions[currentIndex];
      let html = `<h2>問${currentIndex + 1}：${q.question}</h2><ul>`;
      q.choices.forEach((choice, index) => {
        html += `<li><button onclick="answer(${index})">${choice}</button></li>`;
      });
      html += '</ul>';
      container.innerHTML = html;
    }

    function answer(selected) {
      const q = questions[currentIndex];
      if (selected === q.answer) score++;
      currentIndex++;
      showQuestion();
    }

    loadQuestions();
  </script>
</body>
</html>
